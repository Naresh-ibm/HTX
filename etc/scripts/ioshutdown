#! /bin/sh
# @(#)19	1.5.4.1  src/htx/usr/lpp/htx/etc/scripts/ioshutdown, htxconf, htxubuntu 4/28/11 02:14:17

# This script send SIGTERM to all hxssup processes which allows shutdown of
# all htx processes.

# echo "Waiting for htx processes shutdown..."
# ps -aef | grep -i hxssup | awk '{ cmd = sprintf("kill -15 %d", $2); system(cmd);}'
# sleep 10s

#Cores may be generated when BOOTME is ON.This is due to small shutdown interval of 10s.Cores
#will be generated by SCTU and CPU
case $1 in
    start)
        touch /var/lock/subsys/htxioshutdown
    ;;
    stop)
    	echo "Delete any core files generated in /usr/lpp/htx/bin during previous shutdown"
        find /usr/lpp/htx/bin -name core* -delete 
	echo "Waiting for htx processes shutdown..."
        ps -aef | grep -i hxssup | awk '{ cmd = sprintf("kill -15 %d", $2); system(cmd);}'
        sleep 10s
    ;;
esac
